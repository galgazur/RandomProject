function [ output ] = coupon_test( input, d, n, table_value)

%d=största tal i sekvensen
%s=antal "kupongsekvenser" hittade
%r=??
%q=antalet kuponger hittade hittils
%n=antal "kupongsekvenser" totalt
%t=största längden vi räknar med(defineras godtyckligt?)
t = d*5;
s = 0;
count = zeros(1, t-d);

while s < n
    occurs = zeros(d);
    q = 0;
    r = 0;
    while q < d
        j = 0;
        for i=1:length(input)
            j=j+1;
            r=r+1;
            if occurs(input(j)) == 0
                break;
            end
        end
        
        occurs(input(j)) = 1;
        q=q+1;
    end
    
    if r >= t
        count(t-d)=count(t-d)+1;
    else
        count(r-d)=count(r-d)+1;
    end
        s=s+1;
end


%preparing the expected-array
expected = zeros(1, t-d);
for r=1:t-d-1
    div = factorial(d)/d.^r;
    st = stirling(r-1, d-1);
    expected(r) = div*st;    
end
expected(t-d) = 1-((factorial(d)/d.^(t-1))*stirling(t-1, d));

disp(count);
disp(expected);
output = chi_two_test(count, expected, table_value);
end

